{% extends "base.html" %}

{% block title %}íŠ¸ë Œë“œ / Twitter{% endblock %}

{% block content %}
<div class="twitter-container">
    <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” -->
    <div class="left-sidebar">
        <a href="{{ url_for('timeline') }}" class="logo">
            ğŸ¦
        </a>
        
        <nav>
            <a href="{{ url_for('timeline') }}" class="nav-item">
                <span class="nav-icon">ğŸ </span>
                <span class="nav-text">í™ˆ</span>
            </a>
            
            <a href="{{ url_for('explore') }}" class="nav-item">
                <span class="nav-icon">ğŸ”</span>
                <span class="nav-text">íƒìƒ‰í•˜ê¸°</span>
            </a>
            
            <a href="{{ url_for('trending') }}" class="nav-item active">
                <span class="nav-icon">ğŸ“Š</span>
                <span class="nav-text">íŠ¸ë Œë“œ</span>
            </a>
            
            <a href="{{ url_for('notifications') }}" class="nav-item">
                <span class="nav-icon">ğŸ””</span>
                <span class="nav-text">ì•Œë¦¼</span>
                {% if user.unread_notifications_count() > 0 %}
                <span style="background: var(--twitter-blue); color: white; border-radius: 50%; padding: 2px 8px; font-size: 12px; margin-left: 8px;">
                    {{ user.unread_notifications_count() }}
                </span>
                {% endif %}
            </a>
            
            <a href="{{ url_for('messages') }}" class="nav-item">
                <span class="nav-icon">âœ‰ï¸</span>
                <span class="nav-text">ìª½ì§€</span>
                {% if user.unread_messages_count() > 0 %}
                <span style="background: var(--twitter-blue); color: white; border-radius: 50%; padding: 2px 8px; font-size: 12px; margin-left: 8px;">
                    {{ user.unread_messages_count() }}
                </span>
                {% endif %}
            </a>
            
            <a href="{{ url_for('bookmarks') }}" class="nav-item">
                <span class="nav-icon">ğŸ”–</span>
                <span class="nav-text">ë¶ë§ˆí¬</span>
            </a>
            
            <a href="{{ url_for('users_list') }}" class="nav-item">
                <span class="nav-icon">ğŸ‘¥</span>
                <span class="nav-text">ì‚¬ìš©ì</span>
            </a>
            
            <a href="{{ url_for('profile') }}" class="nav-item">
                <span class="nav-icon">ğŸ‘¤</span>
                <span class="nav-text">í”„ë¡œí•„</span>
            </a>
            
            <a href="{{ url_for('logout') }}" class="nav-item">
                <span class="nav-icon">ğŸšª</span>
                <span class="nav-text">ë¡œê·¸ì•„ì›ƒ</span>
            </a>
        </nav>
    </div>
    
    <!-- ì¤‘ì•™ í”¼ë“œ -->
    <div class="main-feed">
        <div class="feed-header">
            <div style="font-size: 20px; font-weight: bold;">íŠ¸ë Œë“œ</div>
        </div>
        
        <!-- íŠ¸ë Œë“œ í—¤ë” -->
        <div style="padding: 20px; border-bottom: 1px solid var(--border-color); background: linear-gradient(135deg, var(--twitter-blue) 0%, #1a8cd8 100%); color: white;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 8px;">ğŸ“Š íŠ¸ë Œë”© í•´ì‹œíƒœê·¸</div>
            <div style="font-size: 15px; opacity: 0.9;">
                ì§€ê¸ˆ ê°€ì¥ ì¸ê¸° ìˆëŠ” í•´ì‹œíƒœê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”
            </div>
        </div>
        
        <!-- íŠ¸ë Œë”© í•´ì‹œíƒœê·¸ ëª©ë¡ -->
        <div id="trending-list">
            {% if trending_tags %}
                {% for hashtag in trending_tags %}
                <a href="{{ url_for('hashtag_page', tag=hashtag.tag) }}" style="text-decoration: none; color: inherit; display: block;">
                    <div class="widget-item" style="border-bottom: 1px solid var(--border-color); padding: 16px 20px; transition: background 0.2s;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div style="flex: 1;">
                                <div style="color: var(--text-secondary); font-size: 13px; margin-bottom: 2px;">
                                    {{ loop.index }}ìœ„ Â· íŠ¸ë Œë”©
                                </div>
                                <div style="font-weight: bold; font-size: 17px; margin: 4px 0; color: var(--text-primary);">
                                    #{{ hashtag.tag }}
                                </div>
                                <div style="color: var(--text-secondary); font-size: 13px;">
                                    {{ hashtag.tweet_count() }} íŠ¸ìœ—
                                </div>
                            </div>
                            <div style="font-size: 32px; opacity: 0.3; margin-left: 16px;">
                                {% if loop.index == 1 %}ğŸ¥‡
                                {% elif loop.index == 2 %}ğŸ¥ˆ
                                {% elif loop.index == 3 %}ğŸ¥‰
                                {% else %}ğŸ“Œ
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </a>
                {% endfor %}
            {% else %}
                <div style="text-align: center; padding: 60px 20px; color: var(--text-secondary);">
                    <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“Š</div>
                    <h3 style="margin-bottom: 8px;">ì•„ì§ íŠ¸ë Œë“œê°€ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p>í•´ì‹œíƒœê·¸ë¥¼ ì‚¬ìš©í•´ì„œ íŠ¸ìœ—ì„ ì‘ì„±í•´ë³´ì„¸ìš”!</p>
                    <p style="margin-top: 12px; font-size: 14px;">
                        ì˜ˆ: "ì˜¤ëŠ˜ #íŒŒì´ì¬ ê³µë¶€í–ˆì–´ìš”! #FlaskëŠ” ì¬ë°Œë„¤ìš”"
                    </p>
                </div>
            {% endif %}
        </div>
        
        <!-- íŠ¸ë Œë“œ ì‚¬ìš© íŒ -->
        {% if trending_tags %}
        <div style="padding: 20px; border-top: 2px solid var(--border-color); background: var(--background-secondary); margin-top: 20px;">
            <h3 style="font-size: 17px; font-weight: bold; margin-bottom: 12px;">ğŸ’¡ í•´ì‹œíƒœê·¸ ì‚¬ìš© íŒ</h3>
            <ul style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; padding-left: 20px;">
                <li>ê´€ë ¨ ì£¼ì œì— ëŒ€í•´ ì´ì•¼ê¸°í•  ë•Œ í•´ì‹œíƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”</li>
                <li>ë„ˆë¬´ ë§ì€ í•´ì‹œíƒœê·¸ëŠ” ì˜¤íˆë ¤ ì—­íš¨ê³¼! 2-3ê°œê°€ ì ë‹¹í•©ë‹ˆë‹¤</li>
                <li>í•´ì‹œíƒœê·¸ëŠ” í•œê¸€, ì˜ë¬¸, ìˆ«ìë¥¼ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤</li>
                <li>ì¸ê¸° í•´ì‹œíƒœê·¸ë¥¼ í™œìš©í•˜ë©´ ë” ë§ì€ ì‚¬ëŒë“¤ì—ê²Œ ë…¸ì¶œë©ë‹ˆë‹¤</li>
            </ul>
        </div>
        {% endif %}
    </div>
    
    <!-- ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°” -->
    <div class="right-sidebar">
        <div class="search-box">
            <form action="{{ url_for('search') }}" method="GET">
                <input type="text" name="q" class="search-input" placeholder="í•´ì‹œíƒœê·¸ ê²€ìƒ‰" value="">
            </form>
        </div>
        
        <div class="widget">
            <div class="widget-header">
                í†µê³„
            </div>
            <div style="padding: 16px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                    <span style="color: var(--text-secondary);">ì´ í•´ì‹œíƒœê·¸</span>
                    <span style="font-weight: bold;">{{ trending_tags|length }}</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--text-secondary);">ì´ íŠ¸ìœ— ìˆ˜</span>
                    <span style="font-weight: bold;">{{ trending_tags|sum(attribute='tweet_count')|default(0) }}</span>
                </div>
            </div>
        </div>
        
        <div class="widget">
            <div class="widget-header">
                ë¹ ë¥¸ ë§í¬
            </div>
            <a href="{{ url_for('explore') }}" style="color: var(--text-primary); text-decoration: none; padding: 16px; display: block; border-bottom: 1px solid var(--border-color);">
                ğŸ” íƒìƒ‰í•˜ê¸°
            </a>
            <a href="{{ url_for('timeline') }}" style="color: var(--text-primary); text-decoration: none; padding: 16px; display: block;">
                ğŸ  íƒ€ì„ë¼ì¸ìœ¼ë¡œ
            </a>
        </div>
    </div>
</div>

<style>
.widget-item:hover {
    background: var(--background-secondary);
}

/* ìˆœìœ„ ë°°ì§€ ìŠ¤íƒ€ì¼ */
.trending-badge {
    display: inline-block;
    background: var(--twitter-blue);
    color: white;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: bold;
    margin-left: 8px;
}

/* íŠ¸ë Œë“œ ì¹´ë“œ í˜¸ë²„ íš¨ê³¼ */
.widget-item {
    cursor: pointer;
}

/* ìƒìœ„ 3ê°œ ê°•ì¡° */
.widget-item:nth-child(1) {
    background: linear-gradient(to right, rgba(255, 215, 0, 0.05), transparent);
}

.widget-item:nth-child(2) {
    background: linear-gradient(to right, rgba(192, 192, 192, 0.05), transparent);
}

.widget-item:nth-child(3) {
    background: linear-gradient(to right, rgba(205, 127, 50, 0.05), transparent);
}
</style>

<script>
// ì‹¤ì‹œê°„ íŠ¸ë Œë“œ ì—…ë°ì´íŠ¸ (ì„ íƒì‚¬í•­)
async function refreshTrends() {
    try {
        const response = await fetch('/api/hashtags/trending?limit=20');
        if (response.ok) {
            const data = await response.json();
            console.log('íŠ¸ë Œë“œ ì—…ë°ì´íŠ¸:', data.hashtags);
            // í•„ìš”ì‹œ UI ì—…ë°ì´íŠ¸ ë¡œì§ ì¶”ê°€
        }
    } catch (error) {
        console.error('íŠ¸ë Œë“œ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
    }
}

// 5ë¶„ë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨ (ì„ íƒì‚¬í•­)
// setInterval(refreshTrends, 5 * 60 * 1000);

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì• ë‹ˆë©”ì´ì…˜
document.addEventListener('DOMContentLoaded', () => {
    const items = document.querySelectorAll('.widget-item');
    items.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateY(20px)';
        setTimeout(() => {
            item.style.transition = 'all 0.3s ease';
            item.style.opacity = '1';
            item.style.transform = 'translateY(0)';
        }, index * 50);
    });
});
</script>
{% endblock %}
